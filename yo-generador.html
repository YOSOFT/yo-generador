<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../granite-qrcode-generator/granite-qrcode-generator.html">
<script src="../jspdf/dist/jspdf.min.js"></script>

<dom-module id="yo-generador">
  <template>
    <style>
      paper-dialog { 
        @apply --layout-vertical;
        @apply --layout-center;
        background-color: white;
        width: 400px;
      }
    </style>
    <paper-button raised on-tap="abrir"  >modal dialog</paper-button>
    <paper-dialog id="dialog" with-backdrop>
      <h2>Reserva de Boleta</h2>

      <paper-input id="inputNombres" label="Nombre Completo" value="{{perfil.nombres}}" auto-validate pattern="^[\u00F1A-Za-z _]*[\u00F1A-Za-z][\u00F1A-Za-z _]*$"
        error-message="Solo letras!" required></paper-input>

      <paper-input id="inputTelefono" label="Celular" value="{{perfil.telefono}}" char-counter maxlength="10"
        auto-validate pattern="^[3][0,1,2,5][0-9]*$" error-message="Solo nÃºmeros!">

      <iron-icon icon="mail" slot="prefix"></iron-icon>
      </paper-input>
      <paper-button raised on-tap="_reservar" >Reservar Ticket</paper-button>
      <granite-qrcode-generator id="qr" mode="alphanumeric" format="png">
      </granite-qrcode-generator>
    </paper-dialog>


  </template>

  <script>
    /**
     * `yo-generador`
     * generador de codigo qr
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class YoGenerador extends Polymer.Element {
      static get is() { return 'yo-generador'; }
      static get properties() {
        return {
          perfil: {
            type: Object,
            value: function () {
              return {};
            }
          },
          validar:{
            type: Boolean,
            value: false
          }
        };
      }
      _reservar() {
        if(this.perfil.nombres && this.perfil.telefono){
          console.log(this.$.inputNombres);
          let dato = this.perfil.nombres + ' ' + this.perfil.telefono;
          console.log(dato);
          this.$.qr.data = dato;
          this.$.qr.generateQRCode();
          this.$.dialog.notifyResize();
          //let doc = new jsPDF();
          //doc.text('Hello world!', 10, 10);
          //doc.save('a4.pdf');
        }
      }
      abrir(){
        this.$.dialog.open();
      }
    }

    window.customElements.define(YoGenerador.is, YoGenerador);
  </script>
</dom-module>